<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Establece el modo de persistencia de SoapServer</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="soapserver.setobject.html">« SoapServer::setObject</a></li>
      <li style="float: right;"><a href="class.soapfault.html">SoapFault »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="class.soapserver.html">SoapServer</a></li>
    <li>Establece el modo de persistencia de SoapServer</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="soapserver.setpersistence" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">SoapServer::setPersistence</h1>
  <p class="verinfo">(PHP 5, PHP 7, PHP 8)</p><p class="refpurpose"><span class="refname">SoapServer::setPersistence</span> &mdash; <span class="dc-title">Establece el modo de persistencia de SoapServer</span></p>

 </div>
 
 <div class="refsect1 description" id="refsect1-soapserver.setpersistence-description">
  <h3 class="title">Descripción</h3>
  <div class="methodsynopsis dc-description">
   <span class="modifier">public</span> <span class="methodname"><strong>SoapServer::setPersistence</strong></span>(<span class="methodparam"><span class="type"><a href="language.types.integer.html" class="type int">int</a></span> <code class="parameter">$mode</code></span>): <span class="type"><a href="language.types.void.html" class="type void">void</a></span></div>

  <p class="para rdfs-comment"> 
   Esta función permite cambiar el estado de persistencia de un objeto SoapServer entre
   peticiones. Esta función permite guardar datos entre peticiones usando sesiones de PHP. Este método
   solamente tiene efecto en un SoapServer después de exportar funciones utilizando <span class="methodname"><a href="soapserver.setclass.html" class="methodname">SoapServer::setClass()</a></span>. 
  </p>
  <blockquote class="note"><p><strong class="note">Nota</strong>: 
   <p class="para"> 
    La persistencia de <strong><code><a href="soap.constants.html#constant.soap-persistence-session">SOAP_PERSISTENCE_SESSION</a></code></strong> solamente hace
    persistentes a los objetos de la clase dad, no los datos estáticos de la clase. En este
    caso, use <var class="varname">$this->bar</var> en lugar de self::$bar. 
   </p>
  </p></blockquote>
  <blockquote class="note"><p><strong class="note">Nota</strong>: 
   <p class="para">
    <strong><code><a href="soap.constants.html#constant.soap-persistence-session">SOAP_PERSISTENCE_SESSION</a></code></strong> serializa datos en el objeto de clase entre peticiones. Para poder adecuadamente utilizar recursos (p.ej. <span class="classname"><a href="class.pdo.html" class="classname">PDO</a></span>), deberían usarse los métodos mágicos <a href="language.oop5.magic.html#object.wakeup" class="link">__wakeup()</a> y <a href="language.oop5.magic.html#object.sleep" class="link">__sleep()</a>. 
   </p>  
  </p></blockquote>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-soapserver.setpersistence-parameters">
  <h3 class="title">Parámetros</h3>
  <p class="para">
   <dl>
    
     <dt><code class="parameter">mode</code></dt>
     <dd>
      <p class="para">
       Una de las constantes <code class="literal">SOAP_PERSISTENCE_XXX</code>.
      </p>
      <p class="para">
       <strong><code><a href="soap.constants.html#constant.soap-persistence-request">SOAP_PERSISTENCE_REQUEST</a></code></strong> - Los datos de SoapServer no persisten entre
       peticiones. Este es el comportamiento <strong>predeterminado</strong> de cualquier objeto
       SoapServer después de llamar a setClass. 
      </p>
      <p class="para">
       <strong><code><a href="soap.constants.html#constant.soap-persistence-session">SOAP_PERSISTENCE_SESSION</a></code></strong> - Los datos de SoapServer persisten entre peticiones.
       Esto se lleva a cabo serializando los datos de la clase SoapServer en
       <var class="varname"><a href="reserved.variables.session.html" class="classname">$_SESSION['_nombre_sesión_falso']</a></var>, ya que
       <span class="function"><a href="function.session-start.html" class="function">session_start()</a></span> debe invocarse antes de establecer este modo de persistencia.
      </p>
     </dd>
    
   </dl>
  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-soapserver.setpersistence-returnvalues">
  <h3 class="title">Valores devueltos</h3>
  <p class="para">
   No devuelve ningún valor.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-soapserver.setpersistence-examples">
  <h3 class="title">Ejemplos</h3>
  <p class="para">
   <div class="example" id="example-5335">
    <p><strong>Ejemplo #1 Ejemplo de <span class="function"><strong>SoapServer::setPersistence()</strong></span></strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /> </span><span style="color: #007700">class </span><span style="color: #0000BB">MyFirstPersistentSoapServer </span><span style="color: #007700">{<br />     private </span><span style="color: #0000BB">$resource</span><span style="color: #007700">; </span><span style="color: #FF8000">// (Tal como PDO, mysqli, etc..)<br />     </span><span style="color: #007700">public </span><span style="color: #0000BB">$mivar1</span><span style="color: #007700">;<br />     public </span><span style="color: #0000BB">$mivar2</span><span style="color: #007700">;<br /><br />     public function </span><span style="color: #0000BB">__construct</span><span style="color: #007700">() {<br />         </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">__wakeup</span><span style="color: #007700">(); </span><span style="color: #FF8000">// Estamos llamando nuestro wakeup para manejar nuestro recurso<br />     </span><span style="color: #007700">}<br /><br />     public function </span><span style="color: #0000BB">__wakeup</span><span style="color: #007700">() {<br />         </span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">resource </span><span style="color: #007700">= </span><span style="color: #0000BB">CodeToStartOurResourceUp</span><span style="color: #007700">();<br />     }<br /><br />     public function </span><span style="color: #0000BB">__sleep</span><span style="color: #007700">() {<br />         </span><span style="color: #FF8000">// Nos aseguramos de omitir $resource aquí, por lo que nuestro datos de sesión persisten<br />         // Un fallo resultará en el fallo durante la deserialilzación de datos<br />         // en la próxima petición; por lo tanto, nuestro SoapObject no sería persistente entre peticiones.<br />         </span><span style="color: #007700">return array(</span><span style="color: #DD0000">'mivar1'</span><span style="color: #007700">,</span><span style="color: #DD0000">'mivar2'</span><span style="color: #007700">);<br />     }<br /> }<br /><br /> try {<br />     </span><span style="color: #0000BB">session_start</span><span style="color: #007700">();<br />     </span><span style="color: #0000BB">$server </span><span style="color: #007700">= new </span><span style="color: #0000BB">SoapServer</span><span style="color: #007700">(</span><span style="color: #0000BB">null</span><span style="color: #007700">, array(</span><span style="color: #DD0000">'uri' </span><span style="color: #007700">=&gt; </span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'REQUEST_URI'</span><span style="color: #007700">]));<br />     </span><span style="color: #0000BB">$server</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setClass</span><span style="color: #007700">(</span><span style="color: #DD0000">'MyFirstPersistentSoapServer'</span><span style="color: #007700">);<br />     </span><span style="color: #FF8000">// setPersistence DEBE invocarse después de setClass, debido a que el comportamiento<br />     // de setClass establece SESSION_PERSISTENCE_REQUEST tras promulgar el método.<br />     </span><span style="color: #0000BB">$server</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">setPersistence</span><span style="color: #007700">(</span><span style="color: #0000BB">SOAP_PERSISTENCE_SESSION</span><span style="color: #007700">);<br />     </span><span style="color: #0000BB">$server</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">handle</span><span style="color: #007700">();<br /> } catch(</span><span style="color: #0000BB">SoapFault $e</span><span style="color: #007700">) {<br />     </span><span style="color: #0000BB">error_log</span><span style="color: #007700">(</span><span style="color: #DD0000">"SOAP ERROR: "</span><span style="color: #007700">. </span><span style="color: #0000BB">$e</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">getMessage</span><span style="color: #007700">());<br /> }<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-soapserver.setpersistence-seealso">
  <h3 class="title">Ver también</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="methodname"><a href="soapserver.setclass.html" class="methodname" rel="rdfs-seeAlso">SoapServer::setClass()</a> - Define la clase que controla las peticiones SOAP</span></li>
   </ul>
  </p>
 </div>

 
</div></div></div></body></html>