<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Devuelve la siguiente fila de datos de un conjunto resultado como un objeto</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.sqlsrv-fetch-array.html">« sqlsrv_fetch_array</a></li>
      <li style="float: right;"><a href="function.sqlsrv-field-metadata.html">sqlsrv_field_metadata »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.sqlsrv.html">SQLSRV Funciones</a></li>
    <li>Devuelve la siguiente fila de datos de un conjunto resultado como un objeto</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.sqlsrv-fetch-object" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">sqlsrv_fetch_object</h1>
  <p class="verinfo">(No version information available, might only be in Git)</p><p class="refpurpose"><span class="refname">sqlsrv_fetch_object</span> &mdash; <span class="dc-title">Devuelve la siguiente fila de datos de un conjunto resultado como un objeto</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.sqlsrv-fetch-object-description">
  <h3 class="title">Descripción</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>sqlsrv_fetch_object</strong></span>(<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="language.types.resource.html" class="type resource">resource</a></span> <code class="parameter">$stmt</code></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="language.types.string.html" class="type string">string</a></span> <code class="parameter">$className</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="language.types.array.html" class="type array">array</a></span> <code class="parameter">$ctorParams</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="language.types.integer.html" class="type int">int</a></span> <code class="parameter">$row</code><span class="initializer"> = ?</span></span>,<br>&nbsp;&nbsp;&nbsp;&nbsp;<span class="methodparam"><span class="type"><a href="language.types.integer.html" class="type int">int</a></span> <code class="parameter">$offset</code><span class="initializer"> = ?</span></span><br>): <span class="type"><a href="language.types.mixed.html" class="type mixed">mixed</a></span></div>

  <p class="para rdfs-comment">
   Devuelve la siguiente fila de datos de un conjunto resultado como una instancia de la clase
   especificada, donde las propiedades correspondientes a los nombres de los campos de la fila recuperada y los valores, se corresponden con
   los valores de la fila recuperada.
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.sqlsrv-fetch-object-parameters">
  <h3 class="title">Parámetros</h3>
  <p class="para">
   <dl>
    
     <dt><code class="parameter">stmt</code></dt>
     <dd>
      <p class="para">
       Un recurso de consulta creado por <span class="function"><a href="function.sqlsrv-query.html" class="function">sqlsrv_query()</a></span> o 
       <span class="function"><a href="function.sqlsrv-execute.html" class="function">sqlsrv_execute()</a></span>.
      </p>
     </dd>
    
    
     <dt><code class="parameter">className</code></dt>
     <dd>
      <p class="para">
       El nombre de la clase a instanciar. Si no se especifica el nombre de la clase, 
       se instanciará la clase stdClass.
      </p>
     </dd>
    
    
     <dt><code class="parameter">ctorParams</code></dt>
     <dd>
      <p class="para">
       Los valores pasados al constructor de la clase especificada. Si el constructor 
       de la clase especificada tiene parámetros, se proporcionará el array 
       ctorParams.
      </p>
     </dd>
    
    
     <dt><code class="parameter">row</code></dt>
     <dd>
      <p class="para">
       La fila a la que se accederá. Este parámetro únicamente puede utilizarse si la consulta 
       especificada se preparó con un cursor con scroll. En ese caso, este parámetro 
       puede tomar uno de los siguientes valores:
       <ul class="simplelist">
        <li>SQLSRV_SCROLL_NEXT</li>
        <li>SQLSRV_SCROLL_PRIOR</li>
        <li>SQLSRV_SCROLL_FIRST</li>
        <li>SQLSRV_SCROLL_LAST</li>
        <li>SQLSRV_SCROLL_ABSOLUTE</li>
        <li>SQLSRV_SCROLL_RELATIVE</li>
       </ul>
      </p>
     </dd>
    
    
     <dt><code class="parameter">offset</code></dt>
     <dd>
      <p class="para">
       Especifica la fila a la que se accederá si el parámetro de fila se ha especificado como 
       <strong><code><a href="sqlsrv.constants.html#constant.sqlsrv-scroll-absolute">SQLSRV_SCROLL_ABSOLUTE</a></code></strong> o
       <strong><code><a href="sqlsrv.constants.html#constant.sqlsrv-scroll-relative">SQLSRV_SCROLL_RELATIVE</a></code></strong>. Notar que la primera fila en un 
       conjunto de resultado tiene el índice 0.
      </p>
     </dd>
    
   </dl>
  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.sqlsrv-fetch-object-returnvalues">
  <h3 class="title">Valores devueltos</h3>
  <p class="para"> 
   Devuelve un objeto en caso de éxito, <strong><code><a href="reserved.constants.html#constant.null">null</a></code></strong> si no hay más filas a devolver,
   y <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong> si se produce un error o si la clase especificada no existe.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.sqlsrv-fetch-object-examples">
  <h3 class="title">Ejemplos</h3>
  <p class="para">
   <div class="example" id="example-2010">
    <p><strong>Ejemplo #1 Ejemplo con <span class="function"><strong>sqlsrv_fetch_object()</strong></span></strong></p>
    <div class="example-contents"><p>
    El siguiente ejemplo demuestra cómo devolver una columna como un objeto stdClass.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br />$serverName </span><span style="color: #007700">= </span><span style="color: #DD0000">"serverName\sqlexpress"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$connectionInfo </span><span style="color: #007700">= array( </span><span style="color: #DD0000">"Database"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"dbName"</span><span style="color: #007700">, </span><span style="color: #DD0000">"UID"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"username"</span><span style="color: #007700">, </span><span style="color: #DD0000">"PWD"</span><span style="color: #007700">=&gt;</span><span style="color: #DD0000">"password"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$conn </span><span style="color: #007700">= </span><span style="color: #0000BB">sqlsrv_connect</span><span style="color: #007700">( </span><span style="color: #0000BB">$serverName</span><span style="color: #007700">, </span><span style="color: #0000BB">$connectionInfo</span><span style="color: #007700">);<br />if( </span><span style="color: #0000BB">$conn </span><span style="color: #007700">=== </span><span style="color: #0000BB">false </span><span style="color: #007700">) {<br />     die( </span><span style="color: #0000BB">print_r</span><span style="color: #007700">( </span><span style="color: #0000BB">sqlsrv_errors</span><span style="color: #007700">(), </span><span style="color: #0000BB">true</span><span style="color: #007700">));<br />}<br /><br /></span><span style="color: #0000BB">$sql </span><span style="color: #007700">= </span><span style="color: #DD0000">"SELECT fName, lName FROM Table_1"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$stmt </span><span style="color: #007700">= </span><span style="color: #0000BB">sqlsrv_query</span><span style="color: #007700">( </span><span style="color: #0000BB">$conn</span><span style="color: #007700">, </span><span style="color: #0000BB">$sql</span><span style="color: #007700">);<br />if( </span><span style="color: #0000BB">$stmt </span><span style="color: #007700">=== </span><span style="color: #0000BB">false </span><span style="color: #007700">) {<br />     die( </span><span style="color: #0000BB">print_r</span><span style="color: #007700">( </span><span style="color: #0000BB">sqlsrv_errors</span><span style="color: #007700">(), </span><span style="color: #0000BB">true</span><span style="color: #007700">));<br />}<br /><br /></span><span style="color: #FF8000">// Devolver cada fila como un objeto.<br />// Puesto que no se especifica ninguna clase, cada fila devolverá un objeto stdClass.<br />// Los nombres de propiedades corresponden a nombres de campo.<br /></span><span style="color: #007700">while( </span><span style="color: #0000BB">$obj </span><span style="color: #007700">= </span><span style="color: #0000BB">sqlsrv_fetch_object</span><span style="color: #007700">( </span><span style="color: #0000BB">$stmt</span><span style="color: #007700">)) {<br />      echo </span><span style="color: #0000BB">$obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fName</span><span style="color: #007700">.</span><span style="color: #DD0000">", "</span><span style="color: #007700">.</span><span style="color: #0000BB">$obj</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">lName</span><span style="color: #007700">.</span><span style="color: #DD0000">"&lt;br /&gt;"</span><span style="color: #007700">;<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>


 <div class="refsect1 notes" id="refsect1-function.sqlsrv-fetch-object-notes">
  <h3 class="title">Notas</h3>
  <p class="para">
   Si se especifica un nombre de clase con el parámetro opcional $className y la  
   clase tiene propiedades cuyos nombres coinciden con los nombres de campos del conjunto de resultado, los valores correspondientes
   del conjunto de resultado se aplicarán a las propiedades. Si un nombre de campo del conjunto resultado
   no coincide con ninguna propiedad de clase, una propiedad con el nombre de campo se añadirá al
   objeto del conjunto resultado y el valor del resultado se aplicará a la propiedad. Se aplican las
   reglas siguientes cuando se utiliza el parámetro $className:
   <ul class="simplelist">
      <li>El nombre de propiedad de campo coincidente es sensible al uso de mayúsculas y minúsculas (es case sensitive).</li>
      <li>La coincidencia con la propiedad de campo se da aunque se utilicen modificadores de acceso.</li>
      <li>Los tipos de datos de la propiedad de clase se ignoran cuando se aplica un valor de campo a la propiedad.</li>
      <li>Si la clase no existe, la función devuelve <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong> y añade un error a la colección de errores.</li>
   </ul>
   A pesar de que se defina el parámetro $className, si se devuelve un campo sin 
   nombre, el valor de campo será ignorado y se añadirá una alerta
   a la colección de errores.
  </p>
  <p class="para">
   Cuando se trate un conjunto de resultado que tenga varias columnas con el mismo nombre, podría
   ser mejor utilizar <span class="function"><a href="function.sqlsrv-fetch-array.html" class="function">sqlsrv_fetch_array()</a></span> o la combinación de 
   <span class="function"><a href="function.sqlsrv-fetch.html" class="function">sqlsrv_fetch()</a></span> y <span class="function"><a href="function.sqlsrv-get-field.html" class="function">sqlsrv_get_field()</a></span>.
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.sqlsrv-fetch-object-seealso">
  <h3 class="title">Ver también</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="function"><a href="function.sqlsrv-fetch.html" class="function" rel="rdfs-seeAlso">sqlsrv_fetch()</a> - Hace que est&eacute; disponible para ser le&iacute;da la siguiente fila del conjunto de resultado</span></li>
    <li><span class="function"><a href="function.sqlsrv-fetch-array.html" class="function" rel="rdfs-seeAlso">sqlsrv_fetch_array()</a> - Devuelve una fila como un array</span></li>
   </ul>
  </p>
 </div>

</div></div></div></body></html>