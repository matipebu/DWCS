<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Realizar una recolecci&oacute;n de basura de datos de sesi&oacute;n</title>
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-base.css" />
<link media="all" rel="stylesheet" type="text/css" href="styles/03e73060321a0a848018724a6c83de7f-theme-medium.css" />

 </head>
 <body class="docs"><div class="navbar navbar-fixed-top">
  <div class="navbar-inner clearfix">
    <ul class="nav" style="width: 100%">
      <li style="float: left;"><a href="function.session-encode.html">« session_encode</a></li>
      <li style="float: right;"><a href="function.session-get-cookie-params.html">session_get_cookie_params »</a></li>
    </ul>
  </div>
</div>
<div id="breadcrumbs" class="clearfix">
  <ul class="breadcrumbs-container">
    <li><a href="index.html">PHP Manual</a></li>
    <li><a href="ref.session.html">Funciones de sesi&oacute;n</a></li>
    <li>Realizar una recolecci&oacute;n de basura de datos de sesi&oacute;n</li>
  </ul>
</div>
<div id="layout">
  <div id="layout-content"><div id="function.session-gc" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">session_gc</h1>
  <p class="verinfo">(PHP 7 &gt;= 7.1.0, PHP 8)</p><p class="refpurpose"><span class="refname">session_gc</span> &mdash; <span class="dc-title">Realizar una recolección de basura de datos de sesión</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.session-gc-description">
  <h3 class="title">Descripción</h3>
  <div class="methodsynopsis dc-description">
   <span class="methodname"><strong>session_gc</strong></span>(): <span class="type"><a href="language.types.integer.html" class="type int">int</a></span></div>

  <p class="para rdfs-comment">
   <span class="function"><strong>session_gc()</strong></span> se emplea para la RB (recolección de basura)
   de datos de sesión. PHP hace la RC de sesiones basada en probabilidad de 
   forma predeterminada.
  </p>
  <p class="para">
   LA RB basada en probabilidad funciona en cierto modo aunque tiene algunos problemas. 1) Los
   datos de sesión de sitios con tráfico bajo podrían no borrarse con la frecuencia
   requerida. 2) Los sitios con tráfico alto podrían tener una RB demasiado frecuente. 3) La RB se
   realiza durante la petición del usuario, por lo que este podría experimentar un retraso
   en la RB.
  </p>
  <p class="para">
   Por tanto, se recomienda ejecutar la RB periódicamente para
   sistemas en produción. P.ej., use &quot;cron&quot; para sistemas como UNIX.
   Asegúrese de inhabilitar la RB basada en probabilidad estableciendo
   <a href="session.configuration.html#ini.session.gc-probability" class="link">session.gc_probability</a> 
   a 0.
  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.session-gc-returnvalues">
  <h3 class="title">Valores devueltos</h3>
  <p class="para">
   <span class="function"><strong>session_gc()</strong></span> devuelve el número de datos de sesión
   eliminados en caso de éxito, o <strong><code><a href="reserved.constants.html#constant.false">false</a></code></strong> en caso de fallo.
  </p>
  <p class="para">
   Los manejadores de guardado antiguos no devuelven el número de datos de sesión eliminados, sino
   solamente el indicador de éxito/fallo. Si este es el caso, el número de datos de sesión
   eliminados será 1, sin considerar los datos realmente eliminados.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.session-gc-examples">
  <h3 class="title">Ejemplos</h3>
  <p class="para">
   <div class="example" id="example-4723">
    <p><strong>Ejemplo #1 Ejemplo de <span class="function"><strong>session_gc()</strong></span> para administradores de tareas como cron</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// Nota: Este scriptr debería ejecutarse por el mismo usuario del proceso del servidor web.<br /><br />// Es necesario una sesión activa para inicializar el accesso al almacén de datos de sesión.<br /></span><span style="color: #0000BB">session_start</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// Ejecutar la RB inmediatamente<br /></span><span style="color: #0000BB">session_gc</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">// Limpiar el ID de sesión creado por session_gc()<br /></span><span style="color: #0000BB">session_destroy</span><span style="color: #007700">();<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
   <div class="example" id="example-4724">
    <p><strong>Ejemplo #2 Ejemplo de <span class="function"><strong>session_gc()</strong></span> para un script accesible al usuario</strong></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000"><span style="color: #0000BB">&lt;?php<br /></span><span style="color: #FF8000">// Nota: Se recomienda usar session_gc() con scripts de administradores de taresas, aunque<br />// podría utilizarse como sigue.<br /><br />// Utilizado para la última comprobación de la hora de la última RB<br /></span><span style="color: #0000BB">$gc_time </span><span style="color: #007700">= </span><span style="color: #DD0000">'/tmp/php_session_last_gc'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$gc_period </span><span style="color: #007700">= </span><span style="color: #0000BB">1800</span><span style="color: #007700">;<br /><br /></span><span style="color: #0000BB">session_start</span><span style="color: #007700">();<br /></span><span style="color: #FF8000">// Ejecutar la RB solamente cuando el periodo de RB ha finalizado.<br />// Esto es, llamar a session_gc() en cada petición es desperdiciar recursos.<br /></span><span style="color: #007700">if (</span><span style="color: #0000BB">file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$gc_time</span><span style="color: #007700">)) {<br />    if (</span><span style="color: #0000BB">filemtime</span><span style="color: #007700">(</span><span style="color: #0000BB">$gc_time</span><span style="color: #007700">) &lt; </span><span style="color: #0000BB">time</span><span style="color: #007700">() - </span><span style="color: #0000BB">$gc_period</span><span style="color: #007700">) {<br />        </span><span style="color: #0000BB">session_gc</span><span style="color: #007700">();<br />        </span><span style="color: #0000BB">touch</span><span style="color: #007700">(</span><span style="color: #0000BB">$gc_period</span><span style="color: #007700">);<br />    }<br />} else {<br />    </span><span style="color: #0000BB">touch</span><span style="color: #007700">(</span><span style="color: #0000BB">$gc_period</span><span style="color: #007700">);<br />}<br /></span><span style="color: #0000BB">?&gt;</span></span></code></div>
    </div>

   </div>
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.session-gc-seealso">
  <h3 class="title">Ver también</h3>
  <p class="para">
   <ul class="simplelist">
    <li><span class="function"><a href="function.session-start.html" class="function" rel="rdfs-seeAlso">session_start()</a> - Iniciar una nueva sesi&oacute;n o reanudar la existente</span></li>
    <li><span class="function"><a href="function.session-destroy.html" class="function" rel="rdfs-seeAlso">session_destroy()</a> - Destruye toda la informaci&oacute;n registrada de una sesi&oacute;n</span></li>
    <li><a href="session.configuration.html#ini.session.gc-probability" class="link">session.gc_probability</a></li>
   </ul>
  </p>
 </div>

</div></div></div></body></html>